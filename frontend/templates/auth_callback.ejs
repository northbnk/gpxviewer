<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Authenticating...</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
<script>
const supabase = supabase.createClient('<%= supabaseUrl %>', '<%= supabaseAnonKey %>');
(async () => {
  const { data, error } = await supabase.auth.getSessionFromUrl({ storeSession: true });
  if (data && data.session) {
    await fetch('/auth/store', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ auth_uid: data.session.user.id })
    });
  }
  window.location.href = '/';
})();
</script>
</body>
</html>
